:root {
  /* --- Core palette (sampled from image) --- */
  --cb-bg-900: #212931;   /* deep blue-grey background */
  --cb-bg-800: #252E35;   /* slightly lighter panel fill */
  --cb-ink:     #E7EFE4;   /* primary line/text: pale mint-white */
  --cb-ink-2:   #CFDAD0;   /* secondary line/text */
  --cb-grid:    #5C6668;   /* grid/annotation lines */
  --cb-muted:   #98A5A3;   /* muted labels */
  --cb-edge:    #8C9698;   /* panel edges / dividers */

  --cb-alert:   #CD2730;   /* red markers/dots */
  --cb-alert-2: #Bf2F36;   /* darker red, hover/active */

  /* --- Strokes (diagram-like) --- */
  --cb-stroke-1: 1px;
  --cb-stroke-2: 2px;
  --cb-round: 2px;        /* tiny radius; most boxes are square */

  /* --- Typography --- */
  --cb-font-ui: 'IBM Plex Mono', ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
  --cb-font-head: 'Archivo Narrow', system-ui, -apple-system, Segoe UI, Roboto, sans-serif;

  --cb-tt: uppercase;
  --cb-track-tight: 0.04em;
  --cb-track-wide: 0.08em;

  /* --- Shadows (subtle glow on lines) --- */
  --cb-glow: 0 0 0.5px rgba(231,239,228,.55), 0 0 2px rgba(231,239,228,.18);
}

*{box-sizing:border-box}
html,body{margin:0;padding:0;background:var(--cb-bg-900);color:var(--cb-ink);font-family:var(--cb-font-ui);letter-spacing:var(--cb-track-tight);line-height:1.35;text-rendering:geometricPrecision}
a{color:var(--cb-ink);text-decoration:none;border-bottom:var(--cb-stroke-1) solid var(--cb-muted)}
a:hover{color:var(--cb-alert);border-color:var(--cb-alert)}
.container{max-width:1600px;margin:0 auto;padding:32px}
.card{background:var(--cb-bg-800);border:var(--cb-stroke-2) solid var(--cb-edge);box-shadow:inset 0 0 0 var(--cb-stroke-1) var(--cb-grid);border-radius:0;padding:20px;margin:16px 0}
h1{font-family:var(--cb-font-head);text-transform:var(--cb-tt);letter-spacing:var(--cb-track-wide);font-weight:600;font-size:28px;margin:.2em 0 0.2em}
h2{font-family:var(--cb-font-head);text-transform:var(--cb-tt);letter-spacing:var(--cb-track-wide);font-weight:600;font-size:22px;margin:1.2em 0 .4em}
.note{color:var(--cb-muted);font-size:.82rem;letter-spacing:var(--cb-track-tight)}
.btn{display:inline-block;border:var(--cb-stroke-2) solid var(--cb-ink);padding:.4rem .7rem;background:transparent;color:var(--cb-ink);text-transform:var(--cb-tt);letter-spacing:var(--cb-track-wide);font-weight:600;margin-right:8px;border-radius:var(--cb-round);font-family:var(--cb-font-ui)}
.btn:hover{border-color:var(--cb-alert);color:var(--cb-alert)}
.controls{
  margin:10px 0;
  display:flex;
  gap:10px;
  flex-wrap:wrap;
}
.controls button{
  border:var(--cb-stroke-2) solid var(--cb-ink-2);
  padding:.4rem .7rem;
  background:transparent;
  color:var(--cb-ink-2);
  text-transform:var(--cb-tt);
  letter-spacing:var(--cb-track-wide);
  font-weight:600;
  border-radius:var(--cb-round);
  cursor:pointer;
  font-size:.82rem;
  font-family:var(--cb-font-ui);
  transition:all 0.15s ease;
}
.controls button:hover{
  border-color:var(--cb-alert);
  color:var(--cb-alert);
  box-shadow:var(--cb-glow);
}
#root {
  width: 100%;
  height: 850px;
  background: var(--cb-bg-900);
  border: var(--cb-stroke-2) solid var(--cb-edge);
  border-radius: 0;
  position: relative;
}

/* Node toolbar - custom implementation that scales with zoom */
.node-toolbar {
  position: absolute;
  top: -50px;
  left: 50%;
  transform: translateX(-50%);
  background: var(--card);
  border: 2px solid var(--accent);
  border-radius: 8px;
  padding: 6px;
  box-shadow: 0 4px 20px rgba(0,0,0,.5);
  display: flex;
  gap: 6px;
  pointer-events: all;
  white-space: nowrap;
  z-index: 1000;
}

.node-toolbar button {
  background: var(--card);
  border: 1px solid #223;
  color: var(--ink);
  padding: 8px 12px;
  border-radius: 6px;
  cursor: pointer !important;
  font-size: 13px;
  font-weight: 500;
  white-space: nowrap;
  pointer-events: all;
  user-select: none;
  transition: all 0.15s ease;
}

.node-toolbar button:hover {
  background: var(--accent) !important;
  color: #081020 !important;
  border-color: var(--accent);
}

.node-toolbar button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.node-toolbar button:disabled:hover {
  background: var(--card);
  color: var(--ink);
}

/* React Flow default toolbar styles (keep for compatibility) */
.react-flow__node-toolbar {
  background: var(--card);
  border: 2px solid var(--accent);
  border-radius: 8px;
  padding: 6px;
  box-shadow: 0 4px 20px rgba(0,0,0,.5);
  display: flex;
  gap: 6px;
  pointer-events: all;
  transform-origin: center;
  will-change: transform;
}

.react-flow__node-toolbar button {
  background: var(--card);
  border: 1px solid #223;
  color: var(--ink);
  padding: 8px 12px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 13px;
  font-weight: 500;
  white-space: nowrap;
  pointer-events: all;
  user-select: none;
}

.react-flow__node-toolbar button:hover {
  background: var(--accent);
  color: #081020;
}

.react-flow__node-toolbar button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.react-flow__node-toolbar button:disabled:hover {
  background: var(--card);
  color: var(--ink);
}

/* Custom node styles */
.hvac-node {
  padding: .35rem .5rem;
  border: var(--cb-stroke-2) solid var(--cb-ink-2);
  border-radius: var(--cb-round);
  background: transparent;
  color: var(--cb-ink-2);
  font-size: .85rem;
  text-transform: var(--cb-tt);
  letter-spacing: var(--cb-track-tight);
  text-align: center;
  min-width: 120px;
  font-family: var(--cb-font-ui);
  font-weight: 400;
  transition: all 0.15s ease;
}

.hvac-node:hover {
  border-color: var(--cb-ink);
  color: var(--cb-ink);
  box-shadow: var(--cb-glow);
}

/* Selected state */
.react-flow__node.selected .hvac-node {
  border-color: var(--cb-alert);
  color: var(--cb-alert);
  box-shadow: 0 0 0 2px rgba(205,39,48,.25), var(--cb-glow);
}

.hvac-node.transformer { border-color: #98A5A3; color: #98A5A3; min-height: 100px; }
.hvac-node.panel { border-color: var(--cb-ink); color: var(--cb-ink); min-width: 240px; min-height: 400px; padding: .5rem .7rem; font-weight: 600; }
.hvac-node.thermostat { border-color: #6ee7a1; color: #6ee7a1; min-width: 150px; min-height: 105px; }
.hvac-node.relay { border-color: #98A5A3; color: #98A5A3; min-width: 140px; min-height: 105px; }
.hvac-node.dehumidifier { border-color: #fcd34d; color: #fcd34d; min-width: 160px; min-height: 105px; }
.hvac-node.damper { border-color: #fca5a5; color: #fca5a5; min-width: 120px; }
.hvac-node.equipment { border-color: #98A5A3; color: #98A5A3; min-width: 180px; min-height: 210px; }

/* Configuration button in panel node */
.config-btn {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  border: var(--cb-stroke-1) solid var(--cb-ink-2);
  padding: 0.3rem 0.5rem;
  background: rgba(33, 41, 49, 0.8);
  color: var(--cb-ink-2);
  text-transform: var(--cb-tt);
  letter-spacing: var(--cb-track-wide);
  font-weight: 600;
  border-radius: var(--cb-round);
  cursor: pointer;
  font-size: 0.7rem;
  font-family: var(--cb-font-ui);
  transition: all 0.15s ease;
  z-index: 10;
  white-space: nowrap;
}

.config-btn:hover {
  border-color: var(--cb-alert);
  color: var(--cb-alert);
  background: rgba(33, 41, 49, 0.95);
  box-shadow: var(--cb-glow);
}

/* Custom context menu */
.context-menu {
  position: absolute;
  background: var(--cb-bg-800);
  border: var(--cb-stroke-2) solid var(--cb-ink);
  box-shadow: inset 0 0 0 var(--cb-stroke-1) var(--cb-grid), 0 4px 20px rgba(0,0,0,.5);
  padding: 6px;
  display: flex;
  gap: 6px;
  pointer-events: all;
  z-index: 10;
}

.context-menu button {
  border: var(--cb-stroke-2) solid var(--cb-ink-2);
  padding: .4rem .6rem;
  background: transparent;
  color: var(--cb-ink-2);
  text-transform: var(--cb-tt);
  letter-spacing: var(--cb-track-wide);
  font-weight: 600;
  border-radius: var(--cb-round);
  cursor: pointer;
  font-size: .78rem;
  font-family: var(--cb-font-ui);
  white-space: nowrap;
  transition: all 0.15s ease;
}

.context-menu button:hover {
  border-color: var(--cb-alert);
  color: var(--cb-alert);
  box-shadow: var(--cb-glow);
}

.context-menu button:disabled {
  opacity: 0.4;
  cursor: not-allowed;
  border-color: var(--cb-grid);
  color: var(--cb-grid);
}

.context-menu button:disabled:hover {
  border-color: var(--cb-grid);
  color: var(--cb-grid);
  box-shadow: none;
}

.react-flow__handle {
  width: 8px;
  height: 8px;
  background: var(--cb-ink);
  border: var(--cb-stroke-1) solid var(--cb-bg-900);
  box-shadow: var(--cb-glow);
}

.react-flow__handle.source { background: var(--cb-ink); }
.react-flow__handle.target { background: var(--cb-ink-2); }

.react-flow__edge-path {
  stroke-width: var(--cb-stroke-2);
  stroke: var(--cb-ink-2);
  filter: drop-shadow(var(--cb-glow));
}

.react-flow__edge-text {
  font-size: .7rem;
  fill: var(--cb-muted);
  font-weight: 600;
  font-family: var(--cb-font-ui);
  text-transform: var(--cb-tt);
  letter-spacing: var(--cb-track-wide);
}

.react-flow__edge-textpath {
  dominant-baseline: central;
}

.react-flow__edge-textwrapper {
  pointer-events: all;
}

.react-flow__controls {
  background: var(--cb-bg-800);
  border: var(--cb-stroke-2) solid var(--cb-edge);
  box-shadow: inset 0 0 0 var(--cb-stroke-1) var(--cb-grid);
}

.react-flow__controls button {
  background: transparent;
  border-bottom: var(--cb-stroke-1) solid var(--cb-edge);
  color: var(--cb-ink-2);
  transition: all 0.15s ease;
}

.react-flow__controls button:hover {
  background: transparent;
  color: var(--cb-alert);
}

.react-flow__minimap {
  background: var(--cb-bg-800);
  border: var(--cb-stroke-2) solid var(--cb-edge);
  box-shadow: inset 0 0 0 var(--cb-stroke-1) var(--cb-grid);
}

.react-flow__background {
  background: var(--cb-bg-900);
}

.react-flow__background pattern circle {
  fill: var(--cb-grid);
  opacity: 0.35;
}

.handle-label {
  position: absolute;
  font-size: .65rem;
  color: var(--cb-muted);
  font-weight: 600;
  pointer-events: none;
  background: rgba(33, 41, 49, 0.9);
  padding: 2px 4px;
  border-radius: var(--cb-round);
  font-family: var(--cb-font-ui);
  text-transform: var(--cb-tt);
  letter-spacing: var(--cb-track-wide);
  white-space: nowrap;
}

/* Info panel styling */
#info-panel h3 {
  color: var(--cb-ink);
  font-family: 'Archivo Narrow', sans-serif;
  font-size: 1.1rem;
  margin-top: 1.5rem;
  margin-bottom: 0.5rem;
  border-bottom: 1px solid var(--cb-grid);
  padding-bottom: 0.25rem;
  text-transform: uppercase;
  letter-spacing: 0.04em;
}

#info-panel p {
  margin: 0.75rem 0;
  line-height: 1.6;
  font-size: 0.9rem;
}

#info-panel ul, #info-panel ol {
  margin: 0.5rem 0;
  padding-left: 1.5rem;
  line-height: 1.7;
}

#info-panel li {
  margin: 0.5rem 0;
  font-size: 0.88rem;
}

#info-panel strong {
  color: var(--cb-alert);
  font-weight: 600;
}

#info-panel ul ul, #info-panel ol ul {
  margin-top: 0.25rem;
  margin-bottom: 0.25rem;
}

/* Make info panel scrollable with custom scrollbar */
#info-panel::-webkit-scrollbar {
  width: 8px;
}

#info-panel::-webkit-scrollbar-track {
  background: var(--cb-bg-900);
}

#info-panel::-webkit-scrollbar-thumb {
  background: var(--cb-grid);
  border-radius: 4px;
}

#info-panel::-webkit-scrollbar-thumb:hover {
  background: var(--cb-ink-2);
}

/* Configuration panel styling */
#info-panel table {
  font-size: 0.85rem;
}

#info-panel table th {
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  font-size: 0.75rem;
}

#info-panel table td {
  font-size: 0.82rem;
}

#info-panel h4 {
  font-family: 'Archivo Narrow', sans-serif;
  font-size: 1rem;
  text-transform: uppercase;
  letter-spacing: 0.04em;
}
